var revueDraggable=function(E,l){"use strict";function Q(t){return l.getCurrentScope()?(l.onScopeDispose(t),!0):!1}function k(){const t=new Set,o=e=>{t.delete(e)};return{on:e=>{t.add(e);const s=()=>o(e);return Q(s),{off:s}},off:o,trigger:(...e)=>Promise.all(Array.from(t).map(s=>s(...e)))}}function v(t,o){return o==null?l.unref(t):l.unref(t)[o]}function Z(t){return typeof t=="function"?t():l.unref(t)}const gt=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const dt=Object.prototype.toString,pt=t=>dt.call(t)==="[object Object]",yt=()=>{};function tt(t){return l.getCurrentInstance()}function X(t,o=!0,n){tt()?l.onMounted(t,n):o?t():l.nextTick(t)}function ht(t,o){tt()&&l.onUnmounted(t,o)}function W(t){var o;const n=Z(t);return(o=n==null?void 0:n.$el)!=null?o:n}const mt=gt?window:void 0;function A(...t){let o,n,r,e;if(typeof t[0]=="string"||Array.isArray(t[0])?([n,r,e]=t,o=mt):[o,n,r,e]=t,!o)return yt;Array.isArray(n)||(n=[n]),Array.isArray(r)||(r=[r]);const s=[],f=()=>{s.forEach(h=>h()),s.length=0},b=(h,T,D,P)=>(h.addEventListener(T,D,P),()=>h.removeEventListener(T,D,P)),d=l.watch(()=>[W(o),Z(e)],([h,T])=>{if(f(),!h)return;const D=pt(T)?{...T}:T;s.push(...n.flatMap(P=>r.map(U=>b(h,P,U,D))))},{immediate:!0,flush:"post"}),p=()=>{d(),f()};return Q(p),p}function et(t,o=null){const n=l.getCurrentInstance();let r=()=>{};const e=l.customRef((s,f)=>(r=f,{get(){var b,d;return s(),(d=(b=n==null?void 0:n.proxy)==null?void 0:b.$refs[t])!=null?d:o},set(){}}));return X(r),l.onUpdated(r),e}function G(t,o){for(let n=0,r=t.length;n<r;n++)if(o.apply(o,[t[n],n,t]))return t[n]}function I(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Function]"}function nt(t){return!!("targetTouches"in t&&t.targetTouches&&"changedTouches"in t&&t.changedTouches)}function H(t){return!Number.isNaN(t)}function S(t){return Number.parseInt(t,10)}const z=["Moz","Webkit","O","ms"];function bt(t="transform"){var n,r;if(typeof window>"u")return"";const o=(r=(n=window.document)==null?void 0:n.documentElement)==null?void 0:r.style;if(!o||t in o)return"";for(let e=0;e<z.length;e++)if(ot(t,z[e])in o)return z[e];return""}function ot(t,o){return o?`${o}${vt(t)}`:t}function vt(t){let o="",n=!0;for(let r=0;r<t.length;r++)n?(o+=t[r].toUpperCase(),n=!1):t[r]==="-"?n=!0:o+=t[r];return o}const St=bt();let V="";function Dt(t,o){return V||(V=G(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],n=>I(t[n]))),I(t[V])?t[V](o):!1}function rt(t,o,n){let r=t;do{if(Dt(r,o))return!0;if(r===n)return!1;r=r.parentNode}while(r);return!1}function at(t,o,n,r){if(!t)return;const e={capture:!0,...r};t.addEventListener?t.addEventListener(o,n,e):t[`on${o}`]=n}function st(t,o,n,r){if(!t)return;const e={capture:!0,...r};t.removeEventListener?t.removeEventListener(o,n,e):t[`on${o}`]=null}function wt(t){var r;let o=t.clientHeight;const n=(r=t.ownerDocument.defaultView)==null?void 0:r.getComputedStyle(t);return o+=S(n==null?void 0:n.borderTopWidth),o+=S(n==null?void 0:n.borderBottomWidth),o}function Ct(t){var r;let o=t.clientWidth;const n=(r=t.ownerDocument.defaultView)==null?void 0:r.getComputedStyle(t);return o+=S(n==null?void 0:n.borderLeftWidth),o+=S(n==null?void 0:n.borderRightWidth),o}function Tt(t,o){return G(t.targetTouches,n=>o===n.identifier)||G(t.changedTouches,n=>o===n.identifier)}function Nt(t){if(nt(t)){if(t.targetTouches[0])return t.targetTouches[0].identifier;if(t.changedTouches[0])return t.changedTouches[0].identifier}}function xt(t){var r;let o=t.clientHeight;const n=(r=t.ownerDocument.defaultView)==null?void 0:r.getComputedStyle(t);return o-=S(n==null?void 0:n.paddingTop),o-=S(n==null?void 0:n.paddingBottom),o}function Pt(t){var r;let o=t.clientWidth;const n=(r=t.ownerDocument.defaultView)==null?void 0:r.getComputedStyle(t);return o-=S(n==null?void 0:n.paddingLeft),o-=S(n==null?void 0:n.paddingRight),o}function Et(t,o,n){const e=o===o.ownerDocument.body?{left:0,top:0}:o.getBoundingClientRect(),s=(t.clientX+o.scrollLeft-e.left)/n,f=(t.clientY+o.scrollTop-e.top)/n;return{x:s,y:f}}function Mt(t,o){const n=it(t,"px",o);return{[ot("transform",St)]:n}}function jt(t,o){return it(t,"",o)}function it({x:t,y:o},n="px",r){let e=`translate(${Math.round(t)}${n},${Math.round(o)}${n})`;if(r){const s=`${typeof r.x=="string"?r.x:Math.round(r.x)+n}`,f=`${typeof r.y=="string"?r.y:Math.round(r.y)+n}`;e=`translate(${s}, ${f})${e}`}return e}function Lt(t){if(!t)return;if(!t.getElementById("revue-draggable-style-el")){const n=t.createElement("style");n.type="text/css",n.id="revue-draggable-style-el",n.innerHTML=`.revue-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,n.innerHTML+=`.revue-draggable-transparent-selection *::selection {all: inherit;}
`,t.getElementsByTagName("head")[0].appendChild(n)}t.body&&Ot(t.body,"revue-draggable-transparent-selection")}function $t(t){if(t)try{t.body&&Bt(t.body,"revue-draggable-transparent-selection");const o=(t.defaultView||window).getSelection();o&&o.type!=="Caret"&&o.removeAllRanges()}catch{}}function Ot(t,o){t.classList?t.classList.add(o):t.className.match(new RegExp(`(?:^|\\s)${o}(?!\\S)`))||(t.className+=` ${o}`)}function Bt(t,o){t.classList?t.classList.remove(o):t.className=t.className.replace(new RegExp(`(?:^|\\s)${o}(?!\\S)`,"g"),"")}function kt({bounds:t,x:o,y:n,node:r}){if(!t)return[o,n];if(t=typeof t=="string"?t:Ht(t),typeof t=="string"){const{ownerDocument:e}=r,s=e.defaultView,f=t==="parent"?r.parentNode:e.querySelector(t);if(!(s&&f instanceof s.HTMLElement))throw new Error(`Bounds selector "${t}" could not find an element.`);const b=s.getComputedStyle(r),d=s.getComputedStyle(f),p="offsetLeft"in r?r.offsetLeft:0,h="offsetTop"in r?r.offsetTop:0;t={left:-(p-f.offsetLeft)+S(d.paddingLeft)+S(b.marginLeft),top:-(h-f.offsetTop)+S(d.paddingTop)+S(b.marginTop),right:Pt(f)-Ct(r)-p+S(d.paddingRight)-S(b.marginRight),bottom:xt(f)-wt(r)-h+S(d.paddingBottom)-S(b.marginBottom)}}return H(t.right)&&(o=Math.min(o,t.right)),H(t.bottom)&&(n=Math.min(n,t.bottom)),H(t.left)&&(o=Math.max(o,t.left)),H(t.top)&&(n=Math.max(n,t.top)),[o,n]}function Ut(t,o,n){const r=Math.round(o/t[0])*t[0],e=Math.round(n/t[1])*t[1];return[r,e]}function Ft(t){return t==="both"||t==="x"}function At(t){return t==="both"||t==="y"}function _({e:t,touch:o,node:n,offsetContainer:r,scale:e}){const s=typeof o=="number"&&nt(t)?Tt(t,o):null;if(typeof o=="number"&&!s)return null;const f=r||"offsetParent"in n&&n.offsetParent||n.ownerDocument.body;return Et(s||t,f,e)}function J({node:t,x:o,y:n,lastX:r,lastY:e}){return Number.isNaN(r)?{node:t,deltaX:0,deltaY:0,lastX:o,lastY:n,x:o,y:n}:{node:t,deltaX:o-r,deltaY:n-e,lastX:r,lastY:e,x:o,y:n}}function q({x:t,y:o,data:n}){return{node:n.node,x:t+n.deltaX,y:o+n.deltaY,deltaX:n.deltaX,deltaY:n.deltaY,lastX:t,lastY:o}}function Ht(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom}}function M(...t){typeof process<"u"&&process.env.DRAGGABLE_DEBUG&&console.log(...t)}const lt=t=>{const o=l.reactive(Object.assign({allowAnyClick:!1,cancel:"",handle:"",disabled:!1,enableUserSelectHack:!0,enableTransformFix:!1,offsetParent:void 0,grid:void 0,start:()=>{},move:()=>{},stop:()=>{},mouseDown:()=>{},position:void 0,currentPosition:{x:Number.NaN,y:Number.NaN},positionOffset:void 0,scale:1,axis:"both",defaultClassNameDragging:"revue-draggable-dragging",defaultClassNameDragged:"revue-draggable-dragged",defaultClassName:"revue-draggable",defaultPosition:{x:0,y:0},bounds:!1,dragging:!1,dragged:!1,prevPropsPosition:{x:0,y:0},isElementSVG:!1,update:!0},t));return()=>o},x={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let j=x.mouse;function Y(t,o,n){const r=l.ref(),e=I(o)?o():lt(o)(),s=l.reactive({x:Number.NaN,y:Number.NaN}),f=k(),b=k(),d=k();return l.effectScope().run(()=>{l.watch(()=>e,u=>{u.position&&!u.dragging&&(s.x=Number.NaN,s.y=Number.NaN)});const h=u=>{var c;const m=v(r);if(!e.allowAnyClick&&"button"in u&&u.button!==0)return!1;if(!m||!m.ownerDocument||!m.ownerDocument.body)throw new Error("No ref element found on DragStart!");const{ownerDocument:w}=m;if(e.disabled||!(w.defaultView&&u.target!==null&&u.target instanceof w.defaultView.Node)||e.handle&&!rt(u.target,e.handle,m)||e.cancel&&rt(u.target,e.cancel,m))return;u.type==="touchstart"&&u.preventDefault(),e.touch=Nt(u);const N=_({e:u,touch:e.touch,node:m,offsetContainer:e.offsetParent,scale:e.scale});if(N==null)return;const{x:C,y:a}=N,i=J({node:m,x:C,y:a,lastX:s.x,lastY:s.y});M("DraggableCore: handleDragStart: %j",i);const g=n?!0:(c=e.start)==null?void 0:c.call(e,u,i);if(f.trigger({event:u,data:i}),(g||e.update)===!1)return!1;e.enableUserSelectHack&&Lt(w),e.dragging=!0,s.x=C,s.y=a,at(w,j.move,T),at(w,j.stop,D)},T=u=>{var w;const m=v(r);if(m){const L=_({e:u,touch:e.touch,node:m,offsetContainer:e.offsetParent,scale:e.scale});if(L==null)return;let{x:N,y:C}=L;const a=e.grid;if(a&&Array.isArray(a)){let c=N-s.x,y=C-s.y;if([c,y]=Ut(a,c,y),!c&&!y)return;N=s.x+c,C=s.y+y}const i=J({node:m,x:N,y:C,lastX:s.x,lastY:s.y});M("DraggableCore: handleDrag: %j",i);const g=n?!0:(w=e.move)==null?void 0:w.call(e,u,i);if(b.trigger({event:u,data:i}),(g||e.update)===!1){try{D(new MouseEvent("mouseup"))}catch{const y=document.createEvent("MouseEvents");y.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),D(y)}return}s.x=N,s.y=C}},D=u=>{var w;const m=v(r);if(e.dragging&&m){const L=_({e:u,touch:e.touch,node:m,offsetContainer:e.offsetParent,scale:e.scale});if(L==null)return;const{x:N,y:C}=L,a=J({node:m,x:N,y:C,lastX:s.x,lastY:s.y}),i=n?!0:(w=e.stop)==null?void 0:w.call(e,u,a);if(d.trigger({event:u,data:a}),(i||e.update)===!1)return!1;e.enableUserSelectHack&&$t(m.ownerDocument),M("DraggableCore: handleDragStop: %j",a),e.dragging=!1,M("DraggableCore: Removing handlers"),st(m.ownerDocument,j.move,T),st(m.ownerDocument,j.stop,D)}},P=u=>{var m;if(j=x.mouse,(m=e.mouseDown)==null||m.call(e,u),u.which!=3)return h(u)},U=u=>(j=x.mouse,D(u)),F=u=>(j=x.touch,h(u)),R=u=>(j=x.touch,D(u));X(()=>{if(r.value=W(t),!r.value){console.error("You are trying to use <DraggableCore> without passing a valid node reference. Canceling initialization.");return}A(v(r),x.touch.start,F,{passive:!1}),A(v(r),x.touch.stop,R),A(v(r),x.mouse.start,P),A(v(r),x.mouse.stop,U)})}),{...l.toRefs(e),state:e,onDragStart:f.on,onDrag:b.on,onDragStop:d.on}}function K(t,o){const n=l.ref(),r=lt(o),e=r(),s=k(),f=k(),b=k(),d=k();return l.effectScope().run(()=>{const h=(a,i)=>{M("Draggable: onDragStart: %j",i);const g=q({data:i,...e.currentPosition}),c=e.start?e.start(a,g):e.update;if(s.trigger({event:a,data:g}),typeof c<"u"&&!c)return!1;e.dragging=!0,e.dragged=!0},T=(a,i)=>{if(!e.dragging)return!1;M("Draggable: onDrag: %j",i);const g=q({data:i,...e.currentPosition}),c={x:g.x,y:g.y};if(e.bounds){const[$,O]=kt({bounds:e.bounds,x:c.x,y:c.y,node:i.node});c.x=$,c.y=O,g.x=c.x,g.y=c.y,g.deltaX=c.x-e.currentPosition.x,g.deltaY=c.y-e.currentPosition.y}const y=e.move?e.move(a,g):e.update;if(f.trigger({event:a,data:g}),typeof y<"u"&&!y)return!1;e.currentPosition=c,R()},D=(a,i)=>{if(!e.dragging)return!1;const g=q({data:i,...e.currentPosition}),c=e.stop?e.stop(a,g):e.update;if(b.trigger({event:a,data:g}),typeof c<"u"&&!c)return!1;M("Draggable: onDragStop: %j",i),e.enableTransformFix&&P(),e.dragging=!1},P=()=>{var c,y;const a=v(n);if(!a)return;a.style.transform="",a.style.left="",a.style.top="",a.style.position="relative";const{x:i,y:g}=F.value;a.style.left=`${Math.round(S((c=e.positionOffset)==null?void 0:c.x)||0)+Math.round(Number(i))}px`,a.style.top=`${Math.round(S((y=e.positionOffset)==null?void 0:y.y)||0)+Math.round(Number(g))}px`},U=()=>{const a=v(n);a&&(a.style.transform="",a.style.position="",a.style.left="",a.style.top="")},F=l.computed(()=>{const a=!!e.position||e.dragging,i=e.position||e.defaultPosition;return{x:Ft(e.axis)&&v(a)?e.currentPosition.x:v(i).x,y:At(e.axis)&&v(a)?e.currentPosition.y:v(i).y}}),R=(a=!1)=>{const i=v(n);if(i&&(a||e.update&&e.dragging)){e.enableTransformFix&&U();const g=e.positionOffset,c=e.isElementSVG,y=!c&&Mt(v(F),g)||!1,$=c&&jt(v(F),g)||!1;if(typeof $=="string"&&i.setAttribute("transform",$),y)for(const B of Object.keys(y))B==="transform"&&(y[B]+=`${i.style[B]}`.replace(/translate\((-?\d+?.{0,2},? ?)+\)+/gm,"").trim()),i.style[B]=y[B];const O={el:v(n),style:y,transform:$,classes:u.value};d.trigger(O)}},u=l.computed(()=>({[e.defaultClassName]:!e.disabled,[e.defaultClassNameDragging]:e.dragging,[e.defaultClassNameDragged]:e.dragged})),m=()=>Object.keys(v(u)).forEach(a=>{var i,g;v(u)[a]?(i=v(n))==null||i.classList.toggle(a,!0):(g=v(n))==null||g.classList.toggle(a,!1)});l.watch(u,m);const{onDragStart:w,onDrag:L,onDragStop:N}=Y(t,r,!0);L(({event:a,data:i})=>T(a,i)),w(({event:a,data:i})=>h(a,i)),N(({event:a,data:i})=>D(a,i));const C=(a=!1)=>{const i=e.position;M("Draggable: Updated %j",{position:e.currentPosition,prevPropsPosition:e.prevPropsPosition}),i&&(e.currentPosition=i,e.prevPropsPosition={...i}),e.enableTransformFix?P():R(a)};ht(()=>{e.dragging=!1}),X(()=>{var $;if(n.value=W(t),!n){console.error("You are trying to use <Draggable> without passing a valid target reference.");return}let a=0,i=0;const g=e.position,c=e.defaultPosition,y=($=v(n))==null?void 0:$.style;g&&typeof g.x<"u"?a=g.x:c&&typeof c.x<"u"?a=c.x:y&&y.top&&(a=S(y.top)),g&&typeof g.y<"u"?i=g.y:c&&typeof c.y<"u"?i=c.y:y&&y.left&&(i=S(y.left)),e.currentPosition={x:a,y:i},m(),C(!0),l.watch(()=>e.position,O=>{let B=!1;((O==null?void 0:O.x)!==e.currentPosition.x||O.y!==e.currentPosition.y)&&(B=!0),C(B)})})}),{...l.toRefs(e),state:e,onDragStart:s.on,onDrag:f.on,onDragStop:b.on,onTransformed:d.on}}const Vt=(t,o)=>{const n=l.getCurrentInstance(),r=(n==null?void 0:n.emit)??((e,s)=>{const f=new CustomEvent(e,{detail:s});t.dispatchEvent(f)});if(o.arg==="core"){const{onDrag:e,onDragStop:s,onDragStart:f,state:b}=Y(t,o.value);e(d=>{r("move",d)}),f(d=>{r("start",d)}),s(d=>{r("stop",d)}),t["revue-draggable"]=b}else{const{onDrag:e,onDragStop:s,onDragStart:f,onTransformed:b,state:d}=K(t,o.value);e(p=>{r("move",p)}),f(p=>{r("start",p)}),s(p=>{r("stop",p)}),b(p=>{r("transformed",p)}),t["revue-draggable"]=d}},Yt=(t,o)=>{const n=t;if(typeof n["revue-draggable"]<"u"&&o.value&&JSON.stringify(o.value)!==JSON.stringify(o.oldValue)){const r=n["revue-draggable"];Object.assign(r,o.value)}},ut={[l.isVue3?"mounted":"inserted"]:Vt,[l.isVue3?"beforeUpdate":"update"]:Yt},ct=l.defineComponent({name:"Draggable",props:{axis:{type:String,default:"both"},bounds:{type:[Object,String,Boolean],default:!1},defaultClassName:{type:String,default:"revue-draggable"},defaultClassNameDragging:{type:String,default:"revue-draggable-dragging"},defaultClassNameDragged:{type:String,default:"revue-draggable-dragged"},defaultPosition:{type:Object,default:()=>({x:0,y:0})},scale:{type:Number,default:1},position:{type:Object,default:void 0},positionOffset:{type:Object,default:void 0},allowAnyClick:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},enableUserSelectHack:{type:Boolean,default:!0},enableTransformFix:{type:[Boolean,Object],default:!1},cancel:{type:String,default:void 0},offsetParent:{type:Object,default:()=>{}},grid:{type:Array,default:void 0},handle:{type:String,default:void 0},update:{type:Boolean,default:!0},start:{type:Function,default:()=>{}},move:{type:Function,default:()=>{}},stop:{type:Function,default:()=>{}},mouseDown:{type:Function,default:()=>{}}},emits:["move","start","stop","transformed"],setup(t,{slots:o,emit:n,attrs:r}){const e=et("target",null),{onDrag:s,onDragStart:f,onDragStop:b,onTransformed:d,state:p}=K(e,t);return s(h=>n("move",h)),f(h=>n("start",h)),b(h=>n("stop",h)),d(h=>n("transformed",h)),l.watch(()=>t,h=>Object.assign(p,h),{deep:!0,flush:"post"}),l.isVue3?()=>{if(o.default)return l.h(o.default({state:p})[0],{ref:"target",...r},{})}:()=>{if(o.default)return l.h("div",{ref:"target",...r},o.default({state:p}))}}}),ft=l.defineComponent({name:"DraggableCore",props:{scale:{type:Number,default:1},allowAnyClick:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},enableUserSelectHack:{type:Boolean,default:!0},cancel:{type:String,default:void 0},offsetParent:{type:Object,default:void 0},grid:{type:Array,default:void 0},handle:{type:String,default:void 0},onStart:{type:Function,default:()=>{}},onMove:{type:Function,default:()=>{}},onStop:{type:Function,default:()=>{}},onMouseDown:{type:Function,default:()=>{}}},emits:["start","move","stop"],setup(t,{slots:o,emit:n,attrs:r}){const e=et("core-target",null),{onDrag:s,onDragStart:f,onDragStop:b,state:d}=Y(e,t);return s(p=>n("move",p)),f(p=>n("start",p)),b(p=>n("stop",p)),l.watch(()=>t,p=>Object.assign(d,p),{deep:!0,flush:"post"}),l.isVue3?()=>{if(o.default)return l.h(o.default()[0],{ref:"core-target",...r},{})}:()=>{if(o.default)return l.h("div",{ref:"core-target",...r},o.default())}}}),Rt=t=>{t.component("Draggable",ct),t.component("DraggableCore",ft),t.directive("draggable",ut)};return E.Draggable=ct,E.DraggableCore=ft,E.DraggableDirective=ut,E.DraggablePlugin=Rt,E.useDraggable=K,E.useDraggableCore=Y,Object.defineProperty(E,Symbol.toStringTag,{value:"Module"}),E}({},VueDemi);
